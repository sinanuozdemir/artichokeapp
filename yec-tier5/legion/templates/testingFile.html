<!DOCTYPE html>

<html lang="en" id="html">

<head>

	<title>Lead Management</title>
	<link href="css/bootstrap.css"  rel="stylesheet">

	<!-- Custom CSS -->
	<link href="css/plugins/dataTables.bootstrap.css" rel="stylesheet">
	<link type="text/css" rel="stylesheet" href="css/main.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" />

</head>

<body>
	<!-- Navigation -->
	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
		<section>
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<a class="navbar-brand" href="/lead_generation" id="logo">
					<img src="Icons/Base/tier5_logo.png">
				</a>
			</div>
			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="container">

				<ul class="nav navbar-nav navbar-right">
					<li> 
						<a href="/lead_management" class="navbar-brand" id="LM-wrap">
							<img src="Icons/Base/leadManagement_tab.png" class="nav-icons">
							<p id="LM">Lead Management</p>
						</a>
					</li>
					<li>
						<a class="navbar-brand" id="LG-wrap" href="/lead_generation">
							<img src="Icons/Base/leadGeneration_tab.png" class="nav-icons">
							<p id="LG">Lead Generation</p>
						</a>
					</li>
					<li>
						<a class="navbar-brand" id="settings-wrap" href="/account">
							<img src="Icons/Base/settings_tab.png" class="nav-icons">
							<p id="ss">Account</p>
						</a>
					</li>
				</ul>

			</div>
			<!-- /.navbar-collapse -->
		</section>
		<!-- /.container -->
	</nav>
	<div class="row">
		<div class="col-md-1">
		</div>
		<div class="col-md-10">
			<!--Start of Compiled Leads-->
			<div class="row">
				<table class="overflow-table">
					<th id="team-member-cards">Team Members</th>
					<tbody>
<div id="modularModal"></div> 
						<tr>

							{% for user in users_in_organization %}
							<td class="col-md-2">
								<a >
									<div class="team-member-data">
										<div class="card-top-border">
											<img src="{{user.user_perm.profile_picture.url}}" class="profile-photo">
											<div class="teamMember1">
												<span><b>{{user.user.first_name}}</b></span>
											</div>
										</div>
										<div class="leads-this-month">Leads this Month</div>
										<div class="numLeads">{{user.leads_this_month}}</div>
										<div class="top-perf-search">Top Performing Search</div>
										<div class="lead_history">
											<span class="history_location">Location: Baltimore</span> 
											<br>
											<span class="history_age">Age: 18 - 40</span> 
											<br>
											<span class="history_position">Position: CTO</span> 
											<br>
											<span class="history_interests">Interests: Python, C++</span>
										</div>
									</div>
								</a>
							</td>

{% endfor %}


							<p class="pull-right more-teamMembers"><a href="/all_members">View More</a>
							</p>

						</tr>

					</tbody>
				</table>
			</div>

			<!-- /.panel-heading -->
			<form method="POST"> {% csrf_token %}
				<div class="panel-body" id="panel-id-tag">
					<div class="table-responsive" id="table-tag">
						<table>
							<thead>
								<tr>
									<td>
										<button type="submit" method="POST" class="btn btn-default btn-sm" name="export_selected" value="submit">Export Selected</button>
									</td>

									<td>
										<button type="submit" method="POST" value="submit" name="export_new" class="btn btn-default btn-sm">Export New Leads</button>
									</td>
									<td>
										<button type="submit" method="POST" value="delete" name="delete_selected" class="btn btn-default btn-sm">Delete Selected</button>
									</td>
									<td>
										<button type="button" class="btn btn-default btn-sm" data-container="body" data-toggle="collapse" aria-expanded="false" aria-controls="collapseExample" data-html="true" data-target="#collapseAddLead">Add Leads</button>

									</td>
								</tr>
							</thead>
							<div class="collapse" id="collapseAddLead">
								<div class="well">
									<button type="button" class="close" data-dismiss="collapse" data-toggle="collapse" data-target="#collapseAddLead" aria-label="Close"><span aria-hidden="true">&times;</span>
									</button>
									<form>
										<div class="row" id="paddingLeft">
											<div class="container" >
												<div class="col-md-3">
													<div class="form-group">

														<input type="text" class="form-control" name="age" id="name" placeholder="Full Name">
													</div>
													<div class="form-group">
														<input type="email" name="email" class="form-control" id="email" placeholder="Email">
													</div>
													<div class="form-group">
														<input type="text" name="age" class="form-control" id="age" placeholder="Age">
													</div>
													<div class="form-group">
														<input type="text" class="form-control" id="Job Title" placeholder="Job Title">
													</div>
													<input data-trigger="hover" data-toggle="popover" data-placement="top" data-content='Upload newsletter lists, Twitter Handles (include @), LinkedIn Profiles, or even emails and Legion Analytics will complete your leads. Just click "Autofill Leads".' type="file" name="upload" />
												</div>
												<div class="col-md-3">
													<div class="form-group">

														<input type="text" class="form-control" name="company" id="company" placeholder="Company">
													</div>
													<div class="form-group">
														<input type="url" class="form-control" name="companyURL" id="companyURL" placeholder="Company Website">
													</div>
													<div class="form-group">
														<input type="url" class="form-control" name="personal_home_page" id="personalURL" placeholder="Personal Website">
													</div>
													<div class="form-group">
														<input type="text" class="form-control" name="personal_location" id="location" placeholder="Location">
													</div>
												</div>
												<div class="col-md-3">
													<div class="form-group">

														<input type="url" class="form-control" name="personal_linkedin" id="linkedin" placeholder="LinkedIn URL">
													</div>
													<div class="form-group">
														<input type="text" class="form-control" name="personal_twitter" id="twitter" placeholder="Twitter Handle">
													</div>
													<div class="form-group">
														<input type="url" class="form-control" name="personal_facebook" id="facebook" placeholder="Facebook URL">
													</div>
													<div class="form-group">
														<input type="text" class="form-control" name="note" id="notes" placeholder="Note">
													</div>
													<button type="submit" name="add_lead" class="btn btn-default btn-sm pull-right">Add Lead</button>
													<button type="submit" name="autofill" class="btn btn-primary btn-sm pull-right" data-trigger="hover" data-toggle="popover" data-placement="top" data-content="Enter as much information as you can and Legion Analytics will fill in the rest! ^_^">Autofill Leads</button>
												</div>
											</div>
										</div>
									</form>
								</div>
							</div>
						</table>
							
						<div class="inline-block">
							{% for person in total_leads %}
							<div class="id-card four-signal">
								<div>
									<img class="profile-pic" src="{{person.person.photo}}"/>
								</div>
								
								<p class="lead-name">{{person.person.name}}</p>
								<p class="lead-age">{{person.person.age}}</p>
								<p class="lead-body"><em>{{person.person.jobtitle}}</em> at {{person.person.company}}<br>{{person.person.location}}</p>
								<p class="lead-email">&nbsp;{{person.person.email}}</p>
							</div>
							{% endfor %}
							
								<!--<div class="id-card four-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card three-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card three-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card three-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card two-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card two-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>
							
								<div class="id-card one-signal">
								<div>
									<img class="profile-pic" src="Icons/david.jpg"%}"/>
								</div>
								
								<p class="lead-name">Dave McClure</p>
								<p class="lead-age">40</p>
								<p class="lead-body"><em>Managing Partner</em> at 500 Startups<br>Mountain View, Ca.</p>
								<p class="lead-email">dave@500.co</p>
							</div>-->
							
							
						</div>

						<!--<table class="table table-hover" id="dataTables-example" data-sort-order="desc">
							<thead>
								<tr>
									
									<th data-field="name" data-align="center" data-sortable="true">
										
										<p class="data-header">Full Name</p>
									</th>
									<th class="age-data" data-field="age" data-align="center" data-sortable="true">
										<p class="data-header">Age</p>

									</th>
									<th data-field="email" data-align="center" name="email" data-sortable="true">
										<p class="data-header">Email</p>

									</th>
									<th data-field="twitter" data-align="center" data-sortable="true">
										<p class="data-header">Twitter</p>

									</th>
									<th data-field="linkedin" data-align="center" data-sortable="true">
										<p class="data-header">LinkedIn</p>

									</th>
									<th data-field="company" data-align="center" data-sortable="true">
										<p class="data-header">Company</p>

									</th>
									<th data-field="website" data-align="center" data-sortable="true">
										<p class="data-header">Website</p>

									</th>
									<th data-field="location" data-align="center" data-sortable="true">
										<p class="data-header">Location</p>

									</th>
									<th data-field="owner" data-align="center" data-sortable="true">
										<p class="data-header">Owner</p>

									</th>
									<th data-field="date" data-align="center" data-sortable="true">
										<p class="data-header">Date</p>

									</th>
								</tr>
							</thead>

							<tbody id="lead-management-table">



								<!--onclick ="myFunction({{person.id}});" -->
				<!--{% for person in total_leads %}
						

								<tr class="even gradeC {% if person.new %}info{% endif %}" id="{{person.id}}" >
									<td class="data-filled">
								<input type="checkbox" id="test_{{person.id}}" name="checks" value="{{person.id}}" />
								<label for="test_{{person.id}}"></label >{{person.person.name}}</td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.age}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.email}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.personal_twitter}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.personal_linkedin}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled"></p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.personal_home_page}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.person.location}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.user.first_name}}</p></td>
									<td onclick ="myFunction({{person.id}});" ><p class="data-filled">{{person.date_matched}}</p></td>
								</tr>

								{% endfor %}


<script>
function myFunction(a) {

	  $.post("",
  {
    requesting:a,
  },
  function(data,status){
  	document.getElementById(a).setAttribute("class", "");
  				var dataTarget = "SinanOzdemir"
			var signal = "Icons/Lead Completion/4_signal_blue.png";
			var profImage = data['photo'];
			var age = data['age'];
			var jobTitle = data['job']['title'] + " at " + data['job']['company']
			var email = data['email'];
			var location = data['location'];
			var linkedin = "http://www.linkedin.com/"+data['personal_linkedin'];
			var facebook = "http://www.facebook.com/"+data['personal_facebook'];
			var twitter = "https://www.twitter.com/"+data['personal_twitter'];
			var topics = data['interests'];
			var followerCount = data['snapshot']['followed_by'];
			var notes = ""
			for (var i = 0; i < data['notes'].length; i++){
				note = data['notes'][i];
				notes += "<div class='pop-up-note-box'><p class='trend-topics'>"+note['note_text']+"</p></div><div class='time-stamp'>Added "+note['note_date']+" by "+note['note_author']+"</div>"
			}
			
			var signedInUser = "{{user.first_name}}";
			var linkedin_image = "Icons/Lead Completion/linkedin_icon.png"%}";
			closest_contacts = data['snapshot']['closest_contacts'];
			var news = "";
			for (var i = 0; i < data['news_articles'].length; i++){
				note = data['news_articles'][i];
			 news +="<div class='news-article-container'><a href='"+note['news_url']+"' target='blank'><p class='news-articles'>"
			 +note['news_source']+"</p></a></div>";
			}

  	document.getElementById("modularModal").innerHTML = "<div class='modal fade in' id='"+ dataTarget + "' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='false' style='display: block;'><div class='modal-backdrop fade in'></div><div class='modal-dialog'><div class='modal-content'><div class='modal-header'><button type='button' class='close' data-dismiss='modal' aria-label='Close'><span id='x-close' onclick='closeFunction()' aria-hidden='true'>&times;</span></button><h4 class='modal-title' id='myModalLabel'><strong>"+data['name']+"</strong><img src='"+ signal +"' class='pop-up-signal'></h4></div><div class='modal-body'><div class='row'><div class='col-md-2'><img src='"+ profImage +"' class='pop-up-profile-photo' /></div><div class='col-md-3'><br><p class='popUp-description'>Age: "+age+"</p><p class='popUp-description'>"+jobTitle+"</p><p class='popUp-description'>"+email+"</p><p class='popUp-description'>"+location+"</p><a href='"+facebook + "' target='_blank'><img class='fb-popUp-icon' src={% static "Icons/Lead Completion/facebook_icon.png"%} /></a><a href='"+twitter+"' target='_blank'><img class='tw-popUp-icon' src={% static "Icons/Lead Completion/twitter_icon.png"%} /></a><a href='"+linkedin+"' target='_blank'><img class='lin-popUp-icon' src={% static "Icons/Lead Completion/linkedin_icon.png"%}/></a></div><div class='col-md-1 pull-right'></div><div class='col-md-4 pull-right'><p class='pop-up-header' id='media-articles'>Media Articles</p>"+news+"</div></div><div class='row'><div class='col-md-5'><br><div class='col-md-1'><p class='pop-up-header'>Topics</p></div><div class='col-md-2'></div><div class='col-md-1'></div><div class='pop-up-trend-box'><p class='trend-topics'>"+topics+"</p></div></div><div class='row'><div class='col-md-6 pull-right'><form><input class='pop-up-note-taking-box pop-up-lead-profile' type='text' id='new_note' name='message' placeholder='Enter notes here  !!!'><br/><div class='messages'>"+notes+"</div></div></div></div><div class='row'><div class='col-md-5' id='twit-analysis-container'><br><div class='container-fluid tw-analysis-header'><p class='pop-up-header'>Twitter Analysis</p></div><div class='col-md-2'></div><div class='pop-up-trend-box'><p class='trend-topics'>Followers: <span><a href='"+twitter+"/followers' target='_blank'>"+followerCount+"</a></span><br>Closest Connections: <span>"+closest_contacts+"</span></p></div></div></div></div><div class='modal-footer'><button type='button' id='close-button-modal'  class='btn btn-default' data-dismiss='modal' onclick='closeFunction()'>Close</button><button type='button'  onclick='postNote("+data['id']+")'class='btn btn-primary' id='add-note'>Add Note</button></div></div></div></div></div>";
  });
}
</script>

<script>
function postNote(lead_id) {
	note = document.getElementById('new_note').value;
	  $.post("",
  {
    post_note:note,
    lead_id: lead_id
  },
  function(data,status){
  	myFunction(lead_id);
  
  });
}
</script>
	
	<script>
		function closeFunction(){
			$("#modularModal").empty();
		};
	</script>


							</tbody>
						</table>-->

					</div>
					<!-- /.table-responsive -->

				</div>
				<!-- /.panel-body -->
			</form>




		</div>
		<!--End of Compiled leads-->


	</div>


	<script src="js/jquery.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
	<script src="js/view-more.js"></script>
	<script src="js/moment.js"></script>
	<script src="js/livestamp.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="js/bootstrap.min.js"></script>
	<!-- DataTables JavaScript -->
	<script src="js/plugins/dataTables/jquery.dataTables.js">
	</script>
	<script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>




</body>


</html>
<script>
	$(document).ready(function () {
		$('#dataTables-example').dataTable({
			bFilter: false
		});
	});
	/*  $(function () {
        // Remove Search if user Resets Form or hits Escape!
        $('body, .navbar-collapse form[role="search"] button[type="reset"]').on('click keyup', function(event) {
            console.log(event.currentTarget);
            if (event.which == 27 && $('.navbar-collapse form[role="search"]').hasClass('active') ||
                $(event.currentTarget).attr('type') == 'reset') {
                closeSearch();
            }
        });

        function closeSearch() {
            var $form = $('.navbar-collapse form[role="search"].active')
            $form.find('input').val('');
            $form.removeClass('active');
        }

        // Show Search if form is not active // event.preventDefault() is important, this prevents the form from submitting
        $(document).on('click', '.navbar-collapse form[role="search"]:not(.active) button[type="submit"]', function(event) {
            event.preventDefault();
            var $form = $(this).closest('form'),
                $input = $form.find('input');
            $form.addClass('active');
            $input.focus();

        });
        // ONLY FOR DEMO // Please use $('form').submit(function(event)) to track from submission
        // if your form is ajax remember to call `closeSearch()` to close the search container
        $(document).on('click', '.navbar-collapse form[role="search"].active button[type="submit"]', function(event) {
            event.preventDefault();
            var $form = $(this).closest('form'),
                $input = $form.find('input');
            $('#showSearchTerm').text($input.val());
            closeSearch()
        });
    });*/
</script>
<script>
	$(function () {
		$('[data-toggle="popover"]').popover()
	})
</script>

